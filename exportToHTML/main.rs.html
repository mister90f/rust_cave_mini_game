<html>
<head>
<title>main.rs</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #2aacb8;}
.s4 { color: #6aab73;}
.s5 { color: #d98eb3;}
.s6 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#191a1c">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
main.rs</font>
</center></td></tr></table>
<pre><span class="s0">use </span><span class="s1">std</span><span class="s2">::</span><span class="s1">io</span><span class="s2">::</span><span class="s1">stdin</span><span class="s2">;</span>

<span class="s0">const </span><span class="s1">ROOM_DESCRIPTIONS</span><span class="s2">: [&amp;</span><span class="s1">str</span><span class="s2">; </span><span class="s3">10</span><span class="s2">]=[</span><span class="s4">&quot;&quot;</span><span class="s2">,</span><span class="s4">&quot;&quot;</span><span class="s2">,</span><span class="s4">&quot;&quot;</span><span class="s2">,</span><span class="s4">&quot;&quot;</span><span class="s2">,</span><span class="s4">&quot;&quot;</span><span class="s2">,</span><span class="s4">&quot;&quot;</span><span class="s2">,</span><span class="s4">&quot;&quot;</span><span class="s2">,</span><span class="s4">&quot;&quot;</span><span class="s2">,</span><span class="s4">&quot;&quot;</span><span class="s2">,</span><span class="s4">&quot;&quot;</span><span class="s2">];</span>
<span class="s0">const </span><span class="s1">KEY_DESCRIPTIONS</span><span class="s2">: [&amp;</span><span class="s1">str</span><span class="s2">; </span><span class="s3">3</span><span class="s2">] = [</span><span class="s4">&quot;&quot;</span><span class="s2">,</span><span class="s4">&quot;&quot;</span><span class="s2">,</span><span class="s4">&quot;&quot;</span><span class="s2">];</span>

<span class="s0">struct </span><span class="s1">Room</span><span class="s2">{</span>
    <span class="s1">id</span><span class="s2">: </span><span class="s1">u8</span><span class="s2">,</span>
    <span class="s1">room_name</span><span class="s2">: </span><span class="s1">String</span><span class="s2">,</span>
    <span class="s1">connections</span><span class="s2">: [</span><span class="s1">Option</span><span class="s2">&lt;</span><span class="s1">u8</span><span class="s2">&gt;; </span><span class="s3">4</span><span class="s2">],</span>
    <span class="s1">is_locked</span><span class="s2">: </span><span class="s1">bool</span><span class="s2">,</span>
    <span class="s1">description</span><span class="s2">: </span><span class="s1">String</span><span class="s2">,</span>
    <span class="s1">is_inside</span><span class="s2">: </span><span class="s1">bool</span><span class="s2">,</span>
    <span class="s1">items</span><span class="s2">: </span><span class="s1">Vec</span><span class="s2">&lt;</span><span class="s1">Key</span><span class="s2">&gt;</span>
<span class="s2">}</span>

<span class="s0">struct </span><span class="s1">Key</span><span class="s2">{</span>
    <span class="s1">id</span><span class="s2">: </span><span class="s1">u8</span><span class="s2">,</span>
    <span class="s1">name</span><span class="s2">: </span><span class="s1">String</span><span class="s2">,</span>
    <span class="s1">description</span><span class="s2">: </span><span class="s1">String</span>
<span class="s2">}</span>

<span class="s0">impl </span><span class="s1">Key </span><span class="s2">{</span>
    <span class="s0">fn </span><span class="s1">new</span><span class="s2">(</span><span class="s1">id</span><span class="s2">: </span><span class="s1">u8</span><span class="s2">, </span><span class="s1">name</span><span class="s2">: &amp;</span><span class="s1">str</span><span class="s2">, </span><span class="s1">description</span><span class="s2">: &amp;</span><span class="s1">str</span><span class="s2">) -&gt; </span><span class="s0">Self </span><span class="s2">{</span>
        <span class="s0">Self</span><span class="s2">{</span>
            <span class="s1">id</span><span class="s2">,</span>
            <span class="s1">name</span><span class="s2">: </span><span class="s1">name</span><span class="s2">.</span><span class="s1">to_string</span><span class="s2">(),</span>
            <span class="s1">description</span><span class="s2">: </span><span class="s1">description</span><span class="s2">.</span><span class="s1">to_string</span><span class="s2">()</span>
        <span class="s2">}</span>
    <span class="s2">}</span>
<span class="s2">}</span>

<span class="s0">struct </span><span class="s1">State</span><span class="s2">{</span>
    <span class="s1">position</span><span class="s2">: </span><span class="s1">u8</span>
<span class="s2">}</span>

<span class="s0">impl </span><span class="s1">Room</span><span class="s2">{</span>
    <span class="s0">fn </span><span class="s1">unlock</span><span class="s2">(&amp;</span><span class="s0">mut </span><span class="s5">self</span><span class="s2">, </span><span class="s1">key</span><span class="s2">: &amp;</span><span class="s1">Key</span><span class="s2">){</span>
        <span class="s0">if </span><span class="s5">self</span><span class="s2">.</span><span class="s1">id </span><span class="s2">== </span><span class="s1">key</span><span class="s2">.</span><span class="s1">id </span><span class="s2">{</span>
            <span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;You try to use {}, it works&quot;</span><span class="s2">, </span><span class="s1">key</span><span class="s2">.</span><span class="s1">name</span><span class="s2">);</span>
            <span class="s5">self</span><span class="s2">.</span><span class="s1">is_locked </span><span class="s2">= </span><span class="s0">false</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
            <span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;Doors are closed&quot;</span><span class="s2">)</span>
        <span class="s2">}</span>

    <span class="s2">}</span>
    <span class="s0">fn </span><span class="s1">check_room</span><span class="s2">(&amp;</span><span class="s5">self</span><span class="s2">){</span>
        <span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;You decided to look around. {}&quot;</span><span class="s2">, </span><span class="s5">self</span><span class="s2">.</span><span class="s1">description</span><span class="s2">)</span>
    <span class="s2">}</span>
    <span class="s0">fn </span><span class="s1">search</span><span class="s2">(&amp;</span><span class="s5">self</span><span class="s2">){</span>
        <span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;You tried to find something here.&quot;</span><span class="s2">)</span>

    <span class="s2">}</span>
    <span class="s0">fn </span><span class="s1">new</span><span class="s2">(</span><span class="s1">id</span><span class="s2">: </span><span class="s1">u8</span><span class="s2">, </span><span class="s1">room_name</span><span class="s2">: &amp;</span><span class="s1">str</span><span class="s2">, </span><span class="s1">north</span><span class="s2">: </span><span class="s1">Option</span><span class="s2">&lt;</span><span class="s1">u8</span><span class="s2">&gt;, </span><span class="s1">west</span><span class="s2">: </span><span class="s1">Option</span><span class="s2">&lt;</span><span class="s1">u8</span><span class="s2">&gt;, </span><span class="s1">east</span><span class="s2">: </span><span class="s1">Option</span><span class="s2">&lt;</span><span class="s1">u8</span><span class="s2">&gt;, </span><span class="s1">south</span><span class="s2">: </span><span class="s1">Option</span><span class="s2">&lt;</span><span class="s1">u8</span><span class="s2">&gt;, </span><span class="s1">is_locked</span><span class="s2">: </span><span class="s1">bool</span><span class="s2">, </span><span class="s1">description</span><span class="s2">: &amp;</span><span class="s1">str</span><span class="s2">, </span><span class="s1">is_inside</span><span class="s2">: </span><span class="s1">bool</span><span class="s2">, </span><span class="s1">items</span><span class="s2">:  </span><span class="s1">Vec</span><span class="s2">&lt;</span><span class="s1">Key</span><span class="s2">&gt;) -&gt; </span><span class="s0">Self </span><span class="s2">{</span>
        <span class="s0">Self</span><span class="s2">{</span>
            <span class="s1">id</span><span class="s2">,</span>
            <span class="s1">room_name</span><span class="s2">: </span><span class="s1">room_name</span><span class="s2">.</span><span class="s1">to_string</span><span class="s2">(),</span>
            <span class="s1">connections</span><span class="s2">: [</span><span class="s1">north</span><span class="s2">, </span><span class="s1">west</span><span class="s2">, </span><span class="s1">east</span><span class="s2">, </span><span class="s1">south</span><span class="s2">],</span>
            <span class="s1">is_locked</span><span class="s2">,</span>
            <span class="s1">description</span><span class="s2">: </span><span class="s1">description</span><span class="s2">.</span><span class="s1">to_string</span><span class="s2">(),</span>
            <span class="s1">is_inside</span><span class="s2">,</span>
            <span class="s1">items</span>
        <span class="s2">}</span>
    <span class="s2">}</span>
<span class="s2">}</span>
<span class="s0">impl </span><span class="s1">State</span><span class="s2">{</span>
    <span class="s0">fn </span><span class="s1">change_room</span><span class="s2">(&amp;</span><span class="s0">mut </span><span class="s5">self</span><span class="s2">, </span><span class="s1">room</span><span class="s2">: &amp;</span><span class="s1">Room</span><span class="s2">, </span><span class="s1">side</span><span class="s2">: </span><span class="s1">usize</span><span class="s2">, </span><span class="s1">arr</span><span class="s2">: &amp;[</span><span class="s1">Room</span><span class="s2">]){</span>
        <span class="s0">let </span><span class="s1">num </span><span class="s2">= </span><span class="s1">room</span><span class="s2">.</span><span class="s1">connections</span><span class="s2">[</span><span class="s1">side</span><span class="s2">].</span><span class="s1">unwrap_or</span><span class="s2">(</span><span class="s3">0</span><span class="s2">);</span>
        <span class="s0">if </span><span class="s1">room</span><span class="s2">.</span><span class="s1">connections</span><span class="s2">[</span><span class="s1">side</span><span class="s2">].</span><span class="s1">is_none</span><span class="s2">() {</span>
            <span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;Here is no way&quot;</span><span class="s2">)</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s1">arr</span><span class="s2">[</span><span class="s1">num </span><span class="s0">as </span><span class="s1">usize</span><span class="s2">].</span><span class="s1">is_locked </span><span class="s2">{</span>
                <span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;The doors are locked.&quot;</span><span class="s2">);</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{ </span><span class="s5">self</span><span class="s2">.</span><span class="s1">position </span><span class="s2">= </span><span class="s1">num </span><span class="s2">}</span>
    <span class="s2">}</span>
    <span class="s0">fn </span><span class="s1">new</span><span class="s2">(</span><span class="s1">position</span><span class="s2">: </span><span class="s1">u8</span><span class="s2">)-&gt; </span><span class="s0">Self</span><span class="s2">{</span>
        <span class="s0">Self</span><span class="s2">{</span>
            <span class="s1">position</span>
        <span class="s2">}</span>
    <span class="s2">}</span>
    <span class="s0">fn </span><span class="s1">process_commands</span><span class="s2">(</span><span class="s1">commands</span><span class="s2">: </span><span class="s1">Commands</span><span class="s2">, </span><span class="s1">rooms</span><span class="s2">: &amp;[</span><span class="s1">Room</span><span class="s2">], </span><span class="s1">state</span><span class="s2">: &amp;</span><span class="s0">mut </span><span class="s1">State</span><span class="s2">) {</span>
        <span class="s0">let </span><span class="s1">current_room </span><span class="s2">= &amp;</span><span class="s1">rooms</span><span class="s2">[</span><span class="s1">state</span><span class="s2">.</span><span class="s1">position </span><span class="s0">as </span><span class="s1">usize</span><span class="s2">];</span>

        <span class="s0">match </span><span class="s1">commands </span><span class="s2">{</span>
            <span class="s1">Commands</span><span class="s2">::</span><span class="s1">North </span><span class="s2">=&gt; </span><span class="s1">state</span><span class="s2">.</span><span class="s1">change_room</span><span class="s2">(</span><span class="s1">current_room</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s1">rooms</span><span class="s2">),</span>
            <span class="s1">Commands</span><span class="s2">::</span><span class="s1">West  </span><span class="s2">=&gt; </span><span class="s1">state</span><span class="s2">.</span><span class="s1">change_room</span><span class="s2">(</span><span class="s1">current_room</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rooms</span><span class="s2">),</span>
            <span class="s1">Commands</span><span class="s2">::</span><span class="s1">East  </span><span class="s2">=&gt; </span><span class="s1">state</span><span class="s2">.</span><span class="s1">change_room</span><span class="s2">(</span><span class="s1">current_room</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rooms</span><span class="s2">),</span>
            <span class="s1">Commands</span><span class="s2">::</span><span class="s1">South </span><span class="s2">=&gt; </span><span class="s1">state</span><span class="s2">.</span><span class="s1">change_room</span><span class="s2">(</span><span class="s1">current_room</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s1">rooms</span><span class="s2">),</span>
            <span class="s1">Commands</span><span class="s2">::</span><span class="s1">Search </span><span class="s2">=&gt; </span><span class="s1">current_room</span><span class="s2">.</span><span class="s1">search</span><span class="s2">(),</span>
            <span class="s1">Commands</span><span class="s2">::</span><span class="s1">LookAround </span><span class="s2">=&gt; </span><span class="s1">current_room</span><span class="s2">.</span><span class="s1">check_room</span><span class="s2">(),</span>
            <span class="s1">Commands</span><span class="s2">::</span><span class="s1">Help </span><span class="s2">=&gt; </span><span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;Commands: North, West, East, South, Search, Look, Help&quot;</span><span class="s2">),</span>
        <span class="s2">}</span>
    <span class="s2">}</span>
<span class="s2">}</span>

<span class="s0">enum </span><span class="s1">Commands</span><span class="s2">{</span>
    <span class="s1">North</span><span class="s2">,</span>
    <span class="s1">West</span><span class="s2">,</span>
    <span class="s1">East</span><span class="s2">,</span>
    <span class="s1">South</span><span class="s2">,</span>
    <span class="s1">Search</span><span class="s2">,</span>
    <span class="s1">LookAround</span><span class="s2">,</span>
    <span class="s1">Help</span>
<span class="s2">}</span>
<span class="s0">impl </span><span class="s1">Commands </span><span class="s2">{</span>
    <span class="s0">fn </span><span class="s1">from_input</span><span class="s2">(</span><span class="s1">input</span><span class="s2">: &amp;</span><span class="s1">str</span><span class="s2">) -&gt; </span><span class="s1">Option</span><span class="s2">&lt;</span><span class="s0">Self</span><span class="s2">&gt; {</span>
        <span class="s0">match </span><span class="s1">input</span><span class="s2">.</span><span class="s1">to_lowercase</span><span class="s2">().</span><span class="s1">as_str</span><span class="s2">() {</span>
            <span class="s4">&quot;north&quot; </span><span class="s2">| </span><span class="s4">&quot;n&quot; </span><span class="s2">=&gt; </span><span class="s1">Some</span><span class="s2">(</span><span class="s1">Commands</span><span class="s2">::</span><span class="s1">North</span><span class="s2">),</span>
            <span class="s4">&quot;west&quot;  </span><span class="s2">| </span><span class="s4">&quot;w&quot; </span><span class="s2">=&gt; </span><span class="s1">Some</span><span class="s2">(</span><span class="s1">Commands</span><span class="s2">::</span><span class="s1">West</span><span class="s2">),</span>
            <span class="s4">&quot;east&quot;  </span><span class="s2">| </span><span class="s4">&quot;e&quot; </span><span class="s2">=&gt; </span><span class="s1">Some</span><span class="s2">(</span><span class="s1">Commands</span><span class="s2">::</span><span class="s1">East</span><span class="s2">),</span>
            <span class="s4">&quot;south&quot; </span><span class="s2">| </span><span class="s4">&quot;s&quot; </span><span class="s2">=&gt; </span><span class="s1">Some</span><span class="s2">(</span><span class="s1">Commands</span><span class="s2">::</span><span class="s1">South</span><span class="s2">),</span>
            <span class="s4">&quot;search&quot;      </span><span class="s2">=&gt; </span><span class="s1">Some</span><span class="s2">(</span><span class="s1">Commands</span><span class="s2">::</span><span class="s1">Search</span><span class="s2">),</span>
            <span class="s4">&quot;look&quot;        </span><span class="s2">=&gt; </span><span class="s1">Some</span><span class="s2">(</span><span class="s1">Commands</span><span class="s2">::</span><span class="s1">LookAround</span><span class="s2">),</span>
            <span class="s4">&quot;help&quot;  </span><span class="s2">| </span><span class="s4">&quot;h&quot; </span><span class="s2">=&gt; </span><span class="s1">Some</span><span class="s2">(</span><span class="s1">Commands</span><span class="s2">::</span><span class="s1">Help</span><span class="s2">),</span>
            <span class="s1">_ </span><span class="s2">=&gt; </span><span class="s1">None</span><span class="s2">, </span><span class="s6">// Если ввели ерунду</span>
        <span class="s2">}</span>
    <span class="s2">}</span>
<span class="s2">}</span>


<span class="s0">fn </span><span class="s1">main</span><span class="s2">() {</span>
    <span class="s0">let mut </span><span class="s1">rooms</span><span class="s2">: [</span><span class="s1">Room</span><span class="s2">; </span><span class="s3">10</span><span class="s2">] = [</span>
        <span class="s1">Room</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s4">&quot;Start room&quot;</span><span class="s2">, </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">None</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s0">false</span><span class="s2">, </span><span class="s1">ROOM_DESCRIPTIONS</span><span class="s2">[</span><span class="s3">0</span><span class="s2">], </span><span class="s0">true</span><span class="s2">, </span><span class="s1">Vec</span><span class="s2">::</span><span class="s1">new</span><span class="s2">()),</span>
        <span class="s1">Room</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s4">&quot;First room&quot;</span><span class="s2">, </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">2</span><span class="s2">), </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">5</span><span class="s2">), </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">6</span><span class="s2">), </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">0</span><span class="s2">), </span><span class="s0">false</span><span class="s2">, </span><span class="s1">ROOM_DESCRIPTIONS</span><span class="s2">[</span><span class="s3">1</span><span class="s2">], </span><span class="s0">false</span><span class="s2">, </span><span class="s1">Vec</span><span class="s2">::</span><span class="s1">new</span><span class="s2">()),</span>
        <span class="s1">Room</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s4">&quot;Gloomy room&quot;</span><span class="s2">, </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">3</span><span class="s2">), </span><span class="s1">None</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s0">true</span><span class="s2">, </span><span class="s1">ROOM_DESCRIPTIONS</span><span class="s2">[</span><span class="s3">2</span><span class="s2">], </span><span class="s0">false</span><span class="s2">, </span><span class="s1">Vec</span><span class="s2">::</span><span class="s1">new</span><span class="s2">()),</span>
        <span class="s1">Room</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">3</span><span class="s2">, </span><span class="s4">&quot;Wet room&quot;</span><span class="s2">, </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">4</span><span class="s2">), </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">7</span><span class="s2">), </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">8</span><span class="s2">), </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">2</span><span class="s2">), </span><span class="s0">false</span><span class="s2">, </span><span class="s1">ROOM_DESCRIPTIONS</span><span class="s2">[</span><span class="s3">3</span><span class="s2">], </span><span class="s0">false</span><span class="s2">, </span><span class="s1">Vec</span><span class="s2">::</span><span class="s1">new</span><span class="s2">()),</span>
        <span class="s1">Room</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">4</span><span class="s2">, </span><span class="s4">&quot;Bright room&quot;</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">3</span><span class="s2">), </span><span class="s0">false</span><span class="s2">, </span><span class="s1">ROOM_DESCRIPTIONS</span><span class="s2">[</span><span class="s3">4</span><span class="s2">], </span><span class="s0">false</span><span class="s2">, </span><span class="s1">Vec</span><span class="s2">::</span><span class="s1">new</span><span class="s2">()),</span>
        <span class="s1">Room</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s4">&quot;Bright room&quot;</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">None</span><span class="s2">, </span><span class="s0">true</span><span class="s2">, </span><span class="s1">ROOM_DESCRIPTIONS</span><span class="s2">[</span><span class="s3">5</span><span class="s2">], </span><span class="s0">false</span><span class="s2">, </span><span class="s1">Vec</span><span class="s2">::</span><span class="s1">new</span><span class="s2">()),</span>
        <span class="s1">Room</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">6</span><span class="s2">, </span><span class="s4">&quot;Yellow room&quot;</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">None</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s0">false</span><span class="s2">, </span><span class="s1">ROOM_DESCRIPTIONS</span><span class="s2">[</span><span class="s3">6</span><span class="s2">], </span><span class="s0">false</span><span class="s2">, </span><span class="s1">Vec</span><span class="s2">::</span><span class="s1">new</span><span class="s2">()),</span>
        <span class="s1">Room</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">7</span><span class="s2">, </span><span class="s4">&quot;Green room&quot;</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">3</span><span class="s2">), </span><span class="s1">None</span><span class="s2">, </span><span class="s0">false</span><span class="s2">, </span><span class="s1">ROOM_DESCRIPTIONS</span><span class="s2">[</span><span class="s3">7</span><span class="s2">], </span><span class="s0">false</span><span class="s2">, </span><span class="s1">Vec</span><span class="s2">::</span><span class="s1">new</span><span class="s2">()),</span>
        <span class="s1">Room</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">8</span><span class="s2">, </span><span class="s4">&quot;Corridor&quot;</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">3</span><span class="s2">), </span><span class="s1">None</span><span class="s2">, </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">9</span><span class="s2">), </span><span class="s0">false</span><span class="s2">, </span><span class="s1">ROOM_DESCRIPTIONS</span><span class="s2">[</span><span class="s3">8</span><span class="s2">], </span><span class="s0">false</span><span class="s2">, </span><span class="s1">Vec</span><span class="s2">::</span><span class="s1">new</span><span class="s2">()),</span>
        <span class="s1">Room</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">9</span><span class="s2">, </span><span class="s4">&quot;Final room&quot;</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s1">Some</span><span class="s2">(</span><span class="s3">8</span><span class="s2">), </span><span class="s1">None</span><span class="s2">, </span><span class="s1">None</span><span class="s2">, </span><span class="s0">true</span><span class="s2">, </span><span class="s1">ROOM_DESCRIPTIONS</span><span class="s2">[</span><span class="s3">9</span><span class="s2">], </span><span class="s0">false</span><span class="s2">, </span><span class="s1">Vec</span><span class="s2">::</span><span class="s1">new</span><span class="s2">()),</span>
    <span class="s2">];</span>
       <span class="s0">let </span><span class="s1">key1 </span><span class="s2">= </span><span class="s1">Key</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s4">&quot;White key&quot;</span><span class="s2">, </span><span class="s1">KEY_DESCRIPTIONS</span><span class="s2">[</span><span class="s3">0</span><span class="s2">]);</span>
       <span class="s0">let </span><span class="s1">key2 </span><span class="s2">= </span><span class="s1">Key</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s4">&quot;Black key&quot;</span><span class="s2">, </span><span class="s1">KEY_DESCRIPTIONS</span><span class="s2">[</span><span class="s3">1</span><span class="s2">]);</span>
       <span class="s0">let </span><span class="s1">key3 </span><span class="s2">= </span><span class="s1">Key</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">9</span><span class="s2">, </span><span class="s4">&quot;Golden key&quot;</span><span class="s2">, </span><span class="s1">KEY_DESCRIPTIONS</span><span class="s2">[</span><span class="s3">2</span><span class="s2">]);</span>

    <span class="s1">rooms</span><span class="s2">[</span><span class="s3">6</span><span class="s2">].</span><span class="s1">items</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">key1</span><span class="s2">);</span>
    <span class="s1">rooms</span><span class="s2">[</span><span class="s3">5</span><span class="s2">].</span><span class="s1">items</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">key2</span><span class="s2">);</span>
    <span class="s1">rooms</span><span class="s2">[</span><span class="s3">7</span><span class="s2">].</span><span class="s1">items</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">key3</span><span class="s2">);</span>


    <span class="s0">let mut </span><span class="s1">state</span><span class="s2">= </span><span class="s1">State</span><span class="s2">::</span><span class="s1">new</span><span class="s2">(</span><span class="s3">0</span><span class="s2">);</span>
    <span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;You woke up at the strange room. There is a small light from above. Definitely it is a cave.</span><span class="s0">\n</span><span class="s4">After little rest you decided to leave this cave.&quot;</span><span class="s2">);</span>
    <span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;Use commands like North, West, East, South to move. Type 'Search' to find any objects and 'Look' to look around the room&quot;</span><span class="s2">);</span>
    <span class="s0">loop </span><span class="s2">{</span>

        <span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;Your current position is: {}&quot;</span><span class="s2">, </span><span class="s1">rooms</span><span class="s2">[</span><span class="s1">state</span><span class="s2">.</span><span class="s1">position </span><span class="s0">as </span><span class="s1">usize</span><span class="s2">].</span><span class="s1">room_name</span><span class="s2">);</span>
        <span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;possible directions:&quot;</span><span class="s2">);</span>
            <span class="s0">if </span><span class="s2">!</span><span class="s1">rooms</span><span class="s2">[</span><span class="s1">state</span><span class="s2">.</span><span class="s1">position </span><span class="s0">as </span><span class="s1">usize</span><span class="s2">].</span><span class="s1">connections</span><span class="s2">[</span><span class="s3">0</span><span class="s2">].</span><span class="s1">is_none</span><span class="s2">() { </span><span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;North&quot;</span><span class="s2">) }</span>
            <span class="s0">if </span><span class="s2">!</span><span class="s1">rooms</span><span class="s2">[</span><span class="s1">state</span><span class="s2">.</span><span class="s1">position </span><span class="s0">as </span><span class="s1">usize</span><span class="s2">].</span><span class="s1">connections</span><span class="s2">[</span><span class="s3">1</span><span class="s2">].</span><span class="s1">is_none</span><span class="s2">() { </span><span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;West&quot;</span><span class="s2">) }</span>
            <span class="s0">if </span><span class="s2">!</span><span class="s1">rooms</span><span class="s2">[</span><span class="s1">state</span><span class="s2">.</span><span class="s1">position </span><span class="s0">as </span><span class="s1">usize</span><span class="s2">].</span><span class="s1">connections</span><span class="s2">[</span><span class="s3">2</span><span class="s2">].</span><span class="s1">is_none</span><span class="s2">() { </span><span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;East&quot;</span><span class="s2">) }</span>
            <span class="s0">if </span><span class="s2">!</span><span class="s1">rooms</span><span class="s2">[</span><span class="s1">state</span><span class="s2">.</span><span class="s1">position </span><span class="s0">as </span><span class="s1">usize</span><span class="s2">].</span><span class="s1">connections</span><span class="s2">[</span><span class="s3">3</span><span class="s2">].</span><span class="s1">is_none</span><span class="s2">() { </span><span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;South&quot;</span><span class="s2">) }</span>
        <span class="s0">let </span><span class="s1">input </span><span class="s2">= </span><span class="s1">get_input</span><span class="s2">(</span><span class="s4">&quot;Type the command. If you forget any, type 'Help'&quot;</span><span class="s2">);</span>
        <span class="s0">if let </span><span class="s1">Some</span><span class="s2">(</span><span class="s1">command</span><span class="s2">) = </span><span class="s1">Commands</span><span class="s2">::</span><span class="s1">from_input</span><span class="s2">(&amp;</span><span class="s1">input</span><span class="s2">) {</span>
            <span class="s1">State</span><span class="s2">::</span><span class="s1">process_commands</span><span class="s2">(</span><span class="s1">command</span><span class="s2">, &amp;</span><span class="s1">rooms</span><span class="s2">, &amp;</span><span class="s0">mut </span><span class="s1">state</span><span class="s2">);</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
            <span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;Invalid command&quot;</span><span class="s2">);</span>
        <span class="s2">}</span>
    <span class="s2">}</span>
<span class="s2">}</span>

<span class="s0">fn </span><span class="s1">get_input</span><span class="s2">(</span><span class="s1">prompt</span><span class="s2">: &amp;</span><span class="s1">str</span><span class="s2">) -&gt; </span><span class="s1">String </span><span class="s2">{</span>
    <span class="s1">println</span><span class="s2">!(</span><span class="s4">&quot;{}&quot;</span><span class="s2">, </span><span class="s1">prompt</span><span class="s2">);</span>
    <span class="s0">let mut </span><span class="s1">input </span><span class="s2">= </span><span class="s1">String</span><span class="s2">::</span><span class="s1">new</span><span class="s2">();</span>
    <span class="s1">stdin</span><span class="s2">().</span><span class="s1">read_line</span><span class="s2">(&amp;</span><span class="s0">mut </span><span class="s1">input</span><span class="s2">).</span><span class="s1">expect</span><span class="s2">(</span><span class="s4">&quot;Failed to read line&quot;</span><span class="s2">);</span>
    <span class="s1">input</span><span class="s2">.</span><span class="s1">trim</span><span class="s2">().</span><span class="s1">to_string</span><span class="s2">()</span>
<span class="s2">}</span>
</pre>
</body>
</html>